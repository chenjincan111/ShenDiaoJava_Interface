<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="fthink.dao.DateBusinessTimeMapper">
	<resultMap id="BaseResultMap" type="fthink.entity.DateBusinessTime">
		<id property="deviceNo" column="DEVICE_NO" jdbcType="VARCHAR" />
		<id property="analyDay" column="ANALY_DAY" jdbcType="VARCHAR" />
		<result property="businessTime" column="BUSINESS_TIME" jdbcType="VARCHAR" />
		<result property="timeCount" column="TIME_COUNT" jdbcType="INTEGER" />
		<result property="lastModifyTime" column="LAST_MODIFY_TIME" jdbcType="VARCHAR" />
	</resultMap>

	<sql id="Base_Column_List">
		DEVICE_NO,ANALY_DAY,BUSINESS_TIME,TIME_COUNT,LAST_MODIFY_TIME
	</sql>

	<insert id="insert" parameterType="fthink.entity.DateBusinessTime">
		insert into t_data_business_time
		(DEVICE_NO,ANALY_DAY,BUSINESS_TIME,TIME_COUNT)
		values
		(#{deviceNo,jdbcType=VARCHAR},#{analyDay,jdbcType=VARCHAR},
		#{businessTime,jdbcType=VARCHAR}, #{timeCount,jdbcType=INTEGER})
	</insert>

	 <select id="selectByPrimaryKeys" resultMap="BaseResultMap" parameterType="fthink.entity.DateBusinessTime">
		select <include refid="Base_Column_List" /> from t_data_business_time
		<where>
			DEVICE_NO = #{deviceNo,jdbcType=VARCHAR} and ANALY_DAY = #{analyDay,jdbcType=VARCHAR}
		</where>
		order by ANALY_DAY desc 
	</select>
	
	<select id="selectAnalyDeviceNos" resultMap="BaseResultMap" parameterType="java.util.Map">
		<![CDATA[
			select DEVICE_NO from t_data_business_time where ANALY_DAY<=#{endDate} and ANALY_DAY>=#{startDate} group by DEVICE_NO
		]]>
	</select>
	
	 <select id="selectAllMsg" resultMap="BaseResultMap" parameterType="java.util.Map">
		select <include refid="Base_Column_List" /> from t_data_business_time
		<where>
			<![CDATA[ DEVICE_NO = #{deviceNo} and ANALY_DAY<=#{endDate} and ANALY_DAY>=#{startDate} ]]> 
		</where>
		order by ANALY_DAY desc
	</select>
	
	<update id="updateByPrimaryKey" parameterType="fthink.entity.DataDeviceResult">
		update t_data_business_time t
		set
		t.BUSINESS_TIME=#{businessTime},
		t.TIME_COUNT=#{timeCount},
		t.LAST_MODIFY_TIME=#{lastModifyTime}
		<where>
			DEVICE_NO = #{deviceNo,jdbcType=VARCHAR} and ANALY_DAY = #{analyDay,jdbcType=VARCHAR}
		</where>
	</update>


</mapper>